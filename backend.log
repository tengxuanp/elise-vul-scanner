INFO:root:Starting API (LOG_LEVEL=INFO, ELISE_ML_DEBUG=False, ELISE_ML_MODEL_DIR=-)
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:198: UserWarning: Field name "json" in "ParamLocs" shadows an attribute in parent "BaseModel"
  warnings.warn(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:198: UserWarning: Field name "json" in "FuzzTargets" shadows an attribute in parent "BaseModel"
  warnings.warn(
INFO:backend.modules.ml.enhanced_inference:✅ Successfully imported Enhanced ML modules using absolute import.
INFO:backend.modules.family_router:✅ Enhanced ML system available for family routing
INFO:root:Mounted router: crawl_routes at /api (tag: Crawl)
INFO:root:Mounted router: category_routes at /api (tag: Categorization)
INFO:root:Mounted router: probe_routes at /api (tag: Probe)
INFO:root:Mounted router: recommend_routes at /api (tag: Recommender)
INFO:root:Mounted router: job_routes at /api (tag: Job)
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/xgboost/core.py:160: UserWarning: [17:51:35] WARNING: /Users/runner/work/xgboost/xgboost/src/gbm/../common/error_msg.h:80: If you are loading a serialized model (like pickle in Python, RDS in R) or
configuration generated by an older version of XGBoost, please export the model by calling
`Booster.save_model` from that version first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/stable/tutorials/saving_model.html

for more details about differences between saving model and serializing.

  warnings.warn(smsg, UserWarning)
INFO:backend.modules.ml.enhanced_inference:✅ Loaded enhanced sqli model from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_ranker_sqli.joblib
INFO:backend.modules.ml.enhanced_inference:✅ Loaded sqli scaler from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_scaler_sqli.joblib, expects 48 features
INFO:backend.modules.ml.enhanced_inference:✅ Loaded sqli metadata from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_metadata_sqli.json
INFO:backend.modules.ml.enhanced_inference:✅ Enhanced ML for sqli fully loaded and ready
INFO:backend.modules.ml.enhanced_inference:✅ Loaded enhanced xss model from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_ranker_xss.joblib
INFO:backend.modules.ml.enhanced_inference:✅ Loaded xss scaler from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_scaler_xss.joblib, expects 48 features
INFO:backend.modules.ml.enhanced_inference:✅ Loaded xss metadata from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_metadata_xss.json
INFO:backend.modules.ml.enhanced_inference:✅ Enhanced ML for xss fully loaded and ready
INFO:backend.modules.ml.enhanced_inference:✅ Loaded enhanced redirect model from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_ranker_redirect.joblib
INFO:backend.modules.ml.enhanced_inference:✅ Loaded redirect scaler from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_scaler_redirect.joblib, expects 48 features
INFO:backend.modules.ml.enhanced_inference:✅ Loaded redirect metadata from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_metadata_redirect.json
INFO:backend.modules.ml.enhanced_inference:✅ Enhanced ML for redirect fully loaded and ready
INFO:backend.modules.ml.enhanced_inference:✅ Loaded enhanced sqli model from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_ranker_sqli.joblib
INFO:backend.modules.ml.enhanced_inference:✅ Loaded sqli scaler from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_scaler_sqli.joblib, expects 48 features
INFO:backend.modules.ml.enhanced_inference:✅ Loaded sqli metadata from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_metadata_sqli.json
INFO:backend.modules.ml.enhanced_inference:✅ Enhanced ML for sqli fully loaded and ready
INFO:backend.modules.ml.enhanced_inference:✅ Loaded enhanced xss model from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_ranker_xss.joblib
INFO:backend.modules.ml.enhanced_inference:✅ Loaded xss scaler from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_scaler_xss.joblib, expects 48 features
INFO:backend.modules.ml.enhanced_inference:✅ Loaded xss metadata from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_metadata_xss.json
INFO:backend.modules.ml.enhanced_inference:✅ Enhanced ML for xss fully loaded and ready
INFO:backend.modules.ml.enhanced_inference:✅ Loaded enhanced redirect model from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_ranker_redirect.joblib
INFO:backend.modules.ml.enhanced_inference:✅ Loaded redirect scaler from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_scaler_redirect.joblib, expects 48 features
INFO:backend.modules.ml.enhanced_inference:✅ Loaded redirect metadata from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_metadata_redirect.json
INFO:backend.modules.ml.enhanced_inference:✅ Enhanced ML for redirect fully loaded and ready
INFO:backend.modules.family_router:✅ Enhanced ML engine loaded for family classification
INFO:backend.modules.recommender:Loaded recommender meta: /Users/raphaelpang/code/elise/backend/modules/ml/recommender_meta.json (feature_dim=17)
INFO:backend.modules.recommender:Recommender ready: plugin=False, model=False, pipeline=False, feature_dim=17, rankers_exist={'sqli': True, 'xss': True, 'redirect': True}, family_clf=False, model_dir=/Users/raphaelpang/code/elise/backend/modules/ml
INFO:root:Mounted router: fuzz_routes at /api (tag: Fuzzing)
INFO:root:Mounted router: evidence_routes at /api (tag: Evidence)
INFO:root:Mounted router: verify_routes at /api (tag: Verify)
INFO:root:Mounted router: report_routes at /api (tag: Report)
INFO:backend.modules.ml.enhanced_inference:✅ Loaded enhanced sqli model from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_ranker_sqli.joblib
INFO:backend.modules.ml.enhanced_inference:✅ Loaded sqli scaler from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_scaler_sqli.joblib, expects 48 features
INFO:backend.modules.ml.enhanced_inference:✅ Loaded sqli metadata from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_metadata_sqli.json
INFO:backend.modules.ml.enhanced_inference:✅ Enhanced ML for sqli fully loaded and ready
INFO:backend.modules.ml.enhanced_inference:✅ Loaded enhanced xss model from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_ranker_xss.joblib
INFO:backend.modules.ml.enhanced_inference:✅ Loaded xss scaler from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_scaler_xss.joblib, expects 48 features
INFO:backend.modules.ml.enhanced_inference:✅ Loaded xss metadata from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_metadata_xss.json
INFO:backend.modules.ml.enhanced_inference:✅ Enhanced ML for xss fully loaded and ready
INFO:backend.modules.ml.enhanced_inference:✅ Loaded enhanced redirect model from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_ranker_redirect.joblib
INFO:backend.modules.ml.enhanced_inference:✅ Loaded redirect scaler from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_scaler_redirect.joblib, expects 48 features
INFO:backend.modules.ml.enhanced_inference:✅ Loaded redirect metadata from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_metadata_redirect.json
INFO:backend.modules.ml.enhanced_inference:✅ Enhanced ML for redirect fully loaded and ready
INFO:backend.modules.ml.enhanced_inference:✅ Loaded enhanced sqli model from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_ranker_sqli.joblib
INFO:backend.modules.ml.enhanced_inference:✅ Loaded sqli scaler from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_scaler_sqli.joblib, expects 48 features
INFO:backend.modules.ml.enhanced_inference:✅ Loaded sqli metadata from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_metadata_sqli.json
INFO:backend.modules.ml.enhanced_inference:✅ Enhanced ML for sqli fully loaded and ready
INFO:backend.modules.ml.enhanced_inference:✅ Loaded enhanced xss model from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_ranker_xss.joblib
INFO:backend.modules.ml.enhanced_inference:✅ Loaded xss scaler from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_scaler_xss.joblib, expects 48 features
INFO:backend.modules.ml.enhanced_inference:✅ Loaded xss metadata from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_metadata_xss.json
INFO:backend.modules.ml.enhanced_inference:✅ Enhanced ML for xss fully loaded and ready
INFO:backend.modules.ml.enhanced_inference:✅ Loaded enhanced redirect model from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_ranker_redirect.joblib
INFO:backend.modules.ml.enhanced_inference:✅ Loaded redirect scaler from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_scaler_redirect.joblib, expects 48 features
INFO:backend.modules.ml.enhanced_inference:✅ Loaded redirect metadata from /Users/raphaelpang/code/elise/backend/modules/ml/enhanced_metadata_redirect.json
INFO:backend.modules.ml.enhanced_inference:✅ Enhanced ML for redirect fully loaded and ready
INFO:backend.modules.family_router:✅ Enhanced ML engine loaded for family classification
INFO:root:Mounted router: ml_routes at /api (tag: ML)
INFO:     Started server process [9820]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
✅ Added backend directory to Python path: /Users/raphaelpang/code/elise/backend
✅ Added project root to Python path: /Users/raphaelpang/code/elise
✅ Enhanced ML system loaded successfully
✅ Enhanced ML engine initialized: <backend.modules.ml.enhanced_inference.EnhancedInferenceEngine object at 0x11e369970>
DEBUG: Loading ML Recommender: <backend.modules.recommender.Recommender object at 0x11e4c9ca0>
DEBUG: ML Recommender loaded successfully: <backend.modules.recommender.Recommender object at 0x11e4c9ca0>
DEBUG: Recommender ready: True
DEBUG: Recommender meta: {'feature_dim': 17, 'feature_names': None, 'note': 'Rankers expect [endpoint_feature_vector] + [payload_desc(20)] at inference.', 'families_trained': ['sqli', 'xss', 'redirect']}
INFO:     127.0.0.1:53499 - "POST /api/ml/family/classify HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:53515 - "GET /api/ml HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:53545 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:53578 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:53666 - "POST /api/ml/family_proba HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:53712 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:53750 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature extraction result - count: 48, keys: ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9']...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature values shape: (48,)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature vector shape before scaler: (1, 48)
INFO:backend.modules.ml.enhanced_inference:Using trained sqli model for prediction
INFO:backend.modules.ml.enhanced_inference:DEBUG: About to apply scaler for sqli, feature vector shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler expects 48 features, got 48
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler transformation successful, new shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Classification model prediction - raw_proba: [0.9316624  0.06833761], prediction: 0
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final raw_proba after scalar conversion: 0.06833761185407639
INFO:backend.modules.ml.enhanced_inference:DEBUG: Calibrated probability: 0.06833761185407639
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final confidence score: 0.043757318034577206 for family sqli
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature extraction result - count: 48, keys: ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9']...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature values shape: (48,)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature vector shape before scaler: (1, 48)
INFO:backend.modules.ml.enhanced_inference:Using trained xss model for prediction
INFO:backend.modules.ml.enhanced_inference:DEBUG: About to apply scaler for xss, feature vector shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler expects 48 features, got 48
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler transformation successful, new shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Classification model prediction - raw_proba: [9.9963677e-01 3.6322026e-04], prediction: 0
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final raw_proba after scalar conversion: 0.0003632202569860965
INFO:backend.modules.ml.enhanced_inference:DEBUG: Calibrated probability: 0.0003632202569860965
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final confidence score: 0.0003615224235899674 for family xss
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature extraction result - count: 48, keys: ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9']...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature values shape: (48,)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature vector shape before scaler: (1, 48)
INFO:backend.modules.ml.enhanced_inference:Using trained redirect model for prediction
INFO:backend.modules.ml.enhanced_inference:DEBUG: About to apply scaler for redirect, feature vector shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler expects 48 features, got 48
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler transformation successful, new shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Classification model prediction - raw_proba: [9.9970549e-01 2.9449913e-04], prediction: 0
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final raw_proba after scalar conversion: 0.0002944991283584386
INFO:backend.modules.ml.enhanced_inference:DEBUG: Calibrated probability: 0.0002944991283584386
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final confidence score: 0.00029335673020026623 for family redirect
✅ Enhanced ML used for family prediction: {'sqli': 0.9904671899746059, 'xss': 0.005264417902795259, 'redirect': 0.004268392122598792}
INFO:     127.0.0.1:53774 - "POST /api/ml/family_proba HTTP/1.1" 200 OK
INFO:     127.0.0.1:53802 - "POST /api/ml/recommend HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:53828 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:53852 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature extraction result - count: 48, keys: ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9']...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature values shape: (48,)
INFO:backend.modules.ml.enhanced_inference:Extracted 0 payload-specific features for payload '' OR 1=1--': []...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature vector shape before scaler: (1, 48)
INFO:backend.modules.ml.enhanced_inference:Using trained sqli model for prediction
INFO:backend.modules.ml.enhanced_inference:DEBUG: About to apply scaler for sqli, feature vector shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler expects 48 features, got 48
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler transformation successful, new shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Classification model prediction - raw_proba: [0.79476154 0.20523849], prediction: 0
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final raw_proba after scalar conversion: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Calibrated probability: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final confidence score: 0.054946006167169915 for family sqli
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature extraction result - count: 48, keys: ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9']...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature values shape: (48,)
INFO:backend.modules.ml.enhanced_inference:Extracted 0 payload-specific features for payload '' OR 'a'='a' -- ': []...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature vector shape before scaler: (1, 48)
INFO:backend.modules.ml.enhanced_inference:Using trained sqli model for prediction
INFO:backend.modules.ml.enhanced_inference:DEBUG: About to apply scaler for sqli, feature vector shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler expects 48 features, got 48
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler transformation successful, new shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Classification model prediction - raw_proba: [0.79476154 0.20523849], prediction: 0
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final raw_proba after scalar conversion: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Calibrated probability: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final confidence score: 0.054946006167169915 for family sqli
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature extraction result - count: 48, keys: ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9']...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature values shape: (48,)
INFO:backend.modules.ml.enhanced_inference:Extracted 0 payload-specific features for payload '" OR "a"="a" -- ': []...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature vector shape before scaler: (1, 48)
INFO:backend.modules.ml.enhanced_inference:Using trained sqli model for prediction
INFO:backend.modules.ml.enhanced_inference:DEBUG: About to apply scaler for sqli, feature vector shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler expects 48 features, got 48
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler transformation successful, new shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Classification model prediction - raw_proba: [0.79476154 0.20523849], prediction: 0
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final raw_proba after scalar conversion: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Calibrated probability: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final confidence score: 0.054946006167169915 for family sqli
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature extraction result - count: 48, keys: ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9']...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature values shape: (48,)
INFO:backend.modules.ml.enhanced_inference:Extracted 0 payload-specific features for payload '1 OR 1=1 -- ': []...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature vector shape before scaler: (1, 48)
INFO:backend.modules.ml.enhanced_inference:Using trained sqli model for prediction
INFO:backend.modules.ml.enhanced_inference:DEBUG: About to apply scaler for sqli, feature vector shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler expects 48 features, got 48
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler transformation successful, new shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Classification model prediction - raw_proba: [0.79476154 0.20523849], prediction: 0
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final raw_proba after scalar conversion: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Calibrated probability: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final confidence score: 0.054946006167169915 for family sqli
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature extraction result - count: 48, keys: ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9']...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature values shape: (48,)
INFO:backend.modules.ml.enhanced_inference:Extracted 0 payload-specific features for payload ') OR (1=1) -- ': []...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature vector shape before scaler: (1, 48)
INFO:backend.modules.ml.enhanced_inference:Using trained sqli model for prediction
INFO:backend.modules.ml.enhanced_inference:DEBUG: About to apply scaler for sqli, feature vector shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler expects 48 features, got 48
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler transformation successful, new shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Classification model prediction - raw_proba: [0.79476154 0.20523849], prediction: 0
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final raw_proba after scalar conversion: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Calibrated probability: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final confidence score: 0.054946006167169915 for family sqli
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature extraction result - count: 48, keys: ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9']...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature values shape: (48,)
INFO:backend.modules.ml.enhanced_inference:Extracted 0 payload-specific features for payload '' UNION SELECT NULL-- ': []...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature vector shape before scaler: (1, 48)
INFO:backend.modules.ml.enhanced_inference:Using trained sqli model for prediction
INFO:backend.modules.ml.enhanced_inference:DEBUG: About to apply scaler for sqli, feature vector shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler expects 48 features, got 48
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler transformation successful, new shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Classification model prediction - raw_proba: [0.79476154 0.20523849], prediction: 0
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final raw_proba after scalar conversion: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Calibrated probability: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final confidence score: 0.054946006167169915 for family sqli
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature extraction result - count: 48, keys: ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9']...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature values shape: (48,)
INFO:backend.modules.ml.enhanced_inference:Extracted 0 payload-specific features for payload ''; WAITFOR DELAY '0:0:3'--': []...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature vector shape before scaler: (1, 48)
INFO:backend.modules.ml.enhanced_inference:Using trained sqli model for prediction
INFO:backend.modules.ml.enhanced_inference:DEBUG: About to apply scaler for sqli, feature vector shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler expects 48 features, got 48
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler transformation successful, new shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Classification model prediction - raw_proba: [0.79476154 0.20523849], prediction: 0
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final raw_proba after scalar conversion: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Calibrated probability: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final confidence score: 0.054946006167169915 for family sqli
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature extraction result - count: 48, keys: ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9']...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature values shape: (48,)
INFO:backend.modules.ml.enhanced_inference:Extracted 0 payload-specific features for payload '1)); SELECT pg_sleep(3)--': []...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature vector shape before scaler: (1, 48)
INFO:backend.modules.ml.enhanced_inference:Using trained sqli model for prediction
INFO:backend.modules.ml.enhanced_inference:DEBUG: About to apply scaler for sqli, feature vector shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler expects 48 features, got 48
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler transformation successful, new shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Classification model prediction - raw_proba: [0.79476154 0.20523849], prediction: 0
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final raw_proba after scalar conversion: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Calibrated probability: 0.2052384912967682
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final confidence score: 0.054946006167169915 for family sqli
✅ Enhanced ML used for sqli - 5 payloads ranked
INFO:     127.0.0.1:53871 - "POST /api/ml/recommend HTTP/1.1" 200 OK
INFO:     127.0.0.1:53910 - "POST /api/crawl HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:53938 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:53974 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:54020 - "POST /api/job/start HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:54057 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:54082 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:54114 - "POST /api/job/start HTTP/1.1" 200 OK
INFO:     127.0.0.1:54151 - "POST /api/crawl HTTP/1.1" 200 OK
[INFO] Starting proactive SPA route discovery for http://testfire.net
[INFO] SPA patterns detected: []
[INFO] Proactively discovered 5 SPA routes
INFO:     127.0.0.1:54197 - "GET /api/crawl/status/5c1e104d-c813-42f5-8d2a-0c0a773f7245 HTTP/1.1" 200 OK
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/cgi.exe'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/default.jsp?content=security.htm'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/feedback.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/index.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/login.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/search.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/status_check.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/subscribe.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/survey_questions.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/swagger/index.html'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/doLogin'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
[INFO] SPA patterns detected: []
[INFO] Added 17 SPA routes to discovered endpoints
✅ Grouped & categorized 30 distinct endpoint variants → /Users/raphaelpang/code/elise/data/results/testfire.net/categorized_endpoints.json
INFO:     127.0.0.1:54288 - "GET /api/crawl/status/5c1e104d-c813-42f5-8d2a-0c0a773f7245 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54318 - "GET /api/crawl/result/5c1e104d-c813-42f5-8d2a-0c0a773f7245 HTTP/1.1" 200 OK
INFO:backend.modules.recommender:Loaded recommender meta: /Users/raphaelpang/code/elise/backend/modules/ml/recommender_meta.json (feature_dim=17)
INFO:backend.modules.recommender:Recommender ready: plugin=False, model=False, pipeline=False, feature_dim=17, rankers_exist={'sqli': True, 'xss': True, 'redirect': True}, family_clf=False, model_dir=/Users/raphaelpang/code/elise/backend/modules/ml
INFO:     127.0.0.1:54346 - "POST /api/fuzz HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:54383 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:54408 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:backend.modules.recommender:Loaded recommender meta: /Users/raphaelpang/code/elise/backend/modules/ml/recommender_meta.json (feature_dim=17)
INFO:backend.modules.recommender:Recommender ready: plugin=False, model=False, pipeline=False, feature_dim=17, rankers_exist={'sqli': True, 'xss': True, 'redirect': True}, family_clf=False, model_dir=/Users/raphaelpang/code/elise/backend/modules/ml
Error occurred in event listener
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 480, in dispatch
    g.switch(self._replace_guids_with_channels(params))
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 471, in _listener_with_error_handler_attached
    potential_future = listener(params)
                       ^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 161, in <lambda>
    lambda event: self._on_console_message(event),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 701, in _on_console_message
    page.emit(Page.Events.Console, message)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 220, in emit
    handled = self._call_handlers(event, args, kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 196, in _call_handlers
    self._emit_run(f, args, kwargs)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 81, in _emit_run
    self.emit("error", exc)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 223, in emit
    self._emit_handle_potential_error(event, args[0] if args else None)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 181, in _emit_handle_potential_error
    raise error
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 79, in _emit_run
    coro: Any = f(*args, **kwargs)
                ^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_impl_to_api_mapping.py", line 123, in wrapper_func
    return handler(
           ^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/modules/feature_extractor.py", line 358, in on_console
    if payload and payload in (msg.text() or ""):
                               ^^^^^^^^^^
TypeError: 'str' object is not callable
ERROR:backend.modules.feature_extractor:[Navigation Error] http://testfire.net/search.aspx — Page.content: 'str' object is not callable
WARNING:backend.modules.feature_extractor:[Empty HTML] Could not extract content from http://testfire.net/search.aspx
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Cimg+src%3Dx+onerror%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    persist_evidence(
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Csvg%2Fonload%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    persist_evidence(
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%22%2F%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    persist_evidence(
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:     127.0.0.1:54432 - "POST /api/fuzz HTTP/1.1" 200 OK
INFO:     127.0.0.1:54544 - "GET /api/fuzz/result/5c1e104d-c813-42f5-8d2a-0c0a773f7245 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54724 - "GET /api/ml/healthz HTTP/1.1" 200 OK
INFO:     127.0.0.1:54751 - "GET /api/ml/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:55669 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:55695 - "GET /api/ml/healthz HTTP/1.1" 200 OK
INFO:     127.0.0.1:55723 - "GET /api/ml/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:56217 - "GET /api/ml/healthz HTTP/1.1" 200 OK
INFO:     127.0.0.1:56256 - "GET /api/ml/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:56299 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:56589 - "GET /api/ml/healthz HTTP/1.1" 200 OK
INFO:     127.0.0.1:56623 - "GET /api/ml/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:56665 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:56997 - "GET /api/ml/healthz HTTP/1.1" 200 OK
INFO:     127.0.0.1:57022 - "GET /api/ml/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:57071 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57734 - "GET /api/ml/healthz HTTP/1.1" 200 OK
INFO:     127.0.0.1:57760 - "GET /api/ml/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:57791 - "GET /health HTTP/1.1" 200 OK
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature extraction result - count: 48, keys: ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9']...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature values shape: (48,)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature vector shape before scaler: (1, 48)
INFO:backend.modules.ml.enhanced_inference:Using trained sqli model for prediction
INFO:backend.modules.ml.enhanced_inference:DEBUG: About to apply scaler for sqli, feature vector shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler expects 48 features, got 48
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler transformation successful, new shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Classification model prediction - raw_proba: [0.9316624  0.06833761], prediction: 0
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final raw_proba after scalar conversion: 0.06833761185407639
INFO:backend.modules.ml.enhanced_inference:DEBUG: Calibrated probability: 0.06833761185407639
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final confidence score: 0.043757318034577206 for family sqli
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature extraction result - count: 48, keys: ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9']...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature values shape: (48,)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature vector shape before scaler: (1, 48)
INFO:backend.modules.ml.enhanced_inference:Using trained xss model for prediction
INFO:backend.modules.ml.enhanced_inference:DEBUG: About to apply scaler for xss, feature vector shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler expects 48 features, got 48
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler transformation successful, new shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Classification model prediction - raw_proba: [9.9963677e-01 3.6322026e-04], prediction: 0
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final raw_proba after scalar conversion: 0.0003632202569860965
INFO:backend.modules.ml.enhanced_inference:DEBUG: Calibrated probability: 0.0003632202569860965
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final confidence score: 0.0003615224235899674 for family xss
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature extraction result - count: 48, keys: ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4', 'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9']...
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature values shape: (48,)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Feature vector shape before scaler: (1, 48)
INFO:backend.modules.ml.enhanced_inference:Using trained redirect model for prediction
INFO:backend.modules.ml.enhanced_inference:DEBUG: About to apply scaler for redirect, feature vector shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler expects 48 features, got 48
INFO:backend.modules.ml.enhanced_inference:DEBUG: Scaler transformation successful, new shape: (1, 48)
INFO:backend.modules.ml.enhanced_inference:DEBUG: Classification model prediction - raw_proba: [9.9970549e-01 2.9449913e-04], prediction: 0
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final raw_proba after scalar conversion: 0.0002944991283584386
INFO:backend.modules.ml.enhanced_inference:DEBUG: Calibrated probability: 0.0002944991283584386
INFO:backend.modules.ml.enhanced_inference:DEBUG: Final confidence score: 0.00029335673020026623 for family redirect
✅ Enhanced ML used for family prediction: {'sqli': 0.9904671899746059, 'xss': 0.005264417902795259, 'redirect': 0.004268392122598792}
INFO:     127.0.0.1:57962 - "POST /api/ml/family_proba HTTP/1.1" 200 OK
INFO:     127.0.0.1:58004 - "GET /api/ml/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:58606 - "GET /api/ml/healthz HTTP/1.1" 200 OK
INFO:     127.0.0.1:58630 - "GET /api/ml/info HTTP/1.1" 200 OK
INFO:     127.0.0.1:58658 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:58705 - "POST /api/job/start HTTP/1.1" 200 OK
INFO:     127.0.0.1:58754 - "POST /api/crawl HTTP/1.1" 200 OK
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/cgi.exe'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/default.jsp?content=security.htm'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/feedback.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/index.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/login.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/search.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/status_check.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/subscribe.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/survey_questions.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/swagger/index.html'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/doLogin'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
[INFO] Starting proactive SPA route discovery for http://testfire.net
[INFO] SPA patterns detected: []
[INFO] Proactively discovered 5 SPA routes
[INFO] SPA patterns detected: []
[INFO] Added 17 SPA routes to discovered endpoints
✅ Grouped & categorized 30 distinct endpoint variants → /Users/raphaelpang/code/elise/data/results/testfire.net/categorized_endpoints.json
INFO:     127.0.0.1:58940 - "GET /api/crawl/status/cc9e8b73-508b-4a68-8194-388ac92a7832 HTTP/1.1" 200 OK
INFO:backend.modules.recommender:Loaded recommender meta: /Users/raphaelpang/code/elise/backend/modules/ml/recommender_meta.json (feature_dim=17)
INFO:backend.modules.recommender:Recommender ready: plugin=False, model=False, pipeline=False, feature_dim=17, rankers_exist={'sqli': True, 'xss': True, 'redirect': True}, family_clf=False, model_dir=/Users/raphaelpang/code/elise/backend/modules/ml
Error occurred in event listener
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 480, in dispatch
    g.switch(self._replace_guids_with_channels(params))
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 471, in _listener_with_error_handler_attached
    potential_future = listener(params)
                       ^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 161, in <lambda>
    lambda event: self._on_console_message(event),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 701, in _on_console_message
    page.emit(Page.Events.Console, message)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 220, in emit
    handled = self._call_handlers(event, args, kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 196, in _call_handlers
    self._emit_run(f, args, kwargs)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 81, in _emit_run
    self.emit("error", exc)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 223, in emit
    self._emit_handle_potential_error(event, args[0] if args else None)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 181, in _emit_handle_potential_error
    raise error
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 79, in _emit_run
    coro: Any = f(*args, **kwargs)
                ^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_impl_to_api_mapping.py", line 123, in wrapper_func
    return handler(
           ^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/modules/feature_extractor.py", line 358, in on_console
    if payload and payload in (msg.text() or ""):
                               ^^^^^^^^^^
TypeError: 'str' object is not callable
ERROR:backend.modules.feature_extractor:[Navigation Error] http://testfire.net/search.aspx — Page.content: 'str' object is not callable
WARNING:backend.modules.feature_extractor:[Empty HTML] Could not extract content from http://testfire.net/search.aspx
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Cimg+src%3Dx+onerror%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    persist_evidence(
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Csvg%2Fonload%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    persist_evidence(
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%22%2F%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    persist_evidence(
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:     127.0.0.1:58972 - "POST /api/fuzz HTTP/1.1" 200 OK
INFO:     127.0.0.1:59928 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:60107 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:60452 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:60475 - "POST /api/job/start HTTP/1.1" 200 OK
INFO:     127.0.0.1:60509 - "POST /api/crawl HTTP/1.1" 200 OK
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/cgi.exe'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/default.jsp?content=security.htm'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/feedback.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/index.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/login.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/search.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/status_check.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/subscribe.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/survey_questions.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/swagger/index.html'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/doLogin'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
[INFO] Starting proactive SPA route discovery for http://testfire.net
[INFO] SPA patterns detected: []
[INFO] Proactively discovered 5 SPA routes
[INFO] SPA patterns detected: []
[INFO] Added 17 SPA routes to discovered endpoints
✅ Grouped & categorized 30 distinct endpoint variants → /Users/raphaelpang/code/elise/data/results/testfire.net/categorized_endpoints.json
INFO:     127.0.0.1:60693 - "GET /api/crawl/status/46e7d4fa-7232-4898-88ae-dd70ae955d68 HTTP/1.1" 200 OK
INFO:backend.modules.recommender:Loaded recommender meta: /Users/raphaelpang/code/elise/backend/modules/ml/recommender_meta.json (feature_dim=17)
INFO:backend.modules.recommender:Recommender ready: plugin=False, model=False, pipeline=False, feature_dim=17, rankers_exist={'sqli': True, 'xss': True, 'redirect': True}, family_clf=False, model_dir=/Users/raphaelpang/code/elise/backend/modules/ml
Error occurred in event listener
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 480, in dispatch
    g.switch(self._replace_guids_with_channels(params))
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 471, in _listener_with_error_handler_attached
    potential_future = listener(params)
                       ^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 161, in <lambda>
    lambda event: self._on_console_message(event),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 701, in _on_console_message
    page.emit(Page.Events.Console, message)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 220, in emit
    handled = self._call_handlers(event, args, kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 196, in _call_handlers
    self._emit_run(f, args, kwargs)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 81, in _emit_run
    self.emit("error", exc)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 223, in emit
    self._emit_handle_potential_error(event, args[0] if args else None)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 181, in _emit_handle_potential_error
    raise error
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 79, in _emit_run
    coro: Any = f(*args, **kwargs)
                ^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_impl_to_api_mapping.py", line 123, in wrapper_func
    return handler(
           ^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/modules/feature_extractor.py", line 358, in on_console
    if payload and payload in (msg.text() or ""):
                               ^^^^^^^^^^
TypeError: 'str' object is not callable
ERROR:backend.modules.feature_extractor:[Navigation Error] http://testfire.net/search.aspx — Page.content: 'str' object is not callable
WARNING:backend.modules.feature_extractor:[Empty HTML] Could not extract content from http://testfire.net/search.aspx
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Cimg+src%3Dx+onerror%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    persist_evidence(
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Csvg%2Fonload%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    persist_evidence(
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%22%2F%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    persist_evidence(
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:     127.0.0.1:60735 - "POST /api/fuzz HTTP/1.1" 200 OK
INFO:     127.0.0.1:61434 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:61460 - "POST /api/job/start HTTP/1.1" 200 OK
INFO:     127.0.0.1:61488 - "POST /api/crawl HTTP/1.1" 200 OK
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/cgi.exe'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/default.jsp?content=security.htm'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/feedback.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/index.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/login.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/search.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/status_check.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/subscribe.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/survey_questions.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/swagger/index.html'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/doLogin'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
[INFO] Starting proactive SPA route discovery for http://testfire.net
[INFO] SPA patterns detected: []
[INFO] Proactively discovered 5 SPA routes
[INFO] SPA patterns detected: []
[INFO] Added 17 SPA routes to discovered endpoints
✅ Grouped & categorized 30 distinct endpoint variants → /Users/raphaelpang/code/elise/data/results/testfire.net/categorized_endpoints.json
INFO:     127.0.0.1:61604 - "GET /api/crawl/status/88d5cbab-791d-4582-9344-546875849711 HTTP/1.1" 200 OK
INFO:backend.modules.recommender:Loaded recommender meta: /Users/raphaelpang/code/elise/backend/modules/ml/recommender_meta.json (feature_dim=17)
INFO:backend.modules.recommender:Recommender ready: plugin=False, model=False, pipeline=False, feature_dim=17, rankers_exist={'sqli': True, 'xss': True, 'redirect': True}, family_clf=False, model_dir=/Users/raphaelpang/code/elise/backend/modules/ml
Error occurred in event listener
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 480, in dispatch
    g.switch(self._replace_guids_with_channels(params))
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 471, in _listener_with_error_handler_attached
    potential_future = listener(params)
                       ^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 161, in <lambda>
    lambda event: self._on_console_message(event),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 701, in _on_console_message
    page.emit(Page.Events.Console, message)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 220, in emit
    handled = self._call_handlers(event, args, kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 196, in _call_handlers
    self._emit_run(f, args, kwargs)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 81, in _emit_run
    self.emit("error", exc)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 223, in emit
    self._emit_handle_potential_error(event, args[0] if args else None)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 181, in _emit_handle_potential_error
    raise error
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 79, in _emit_run
    coro: Any = f(*args, **kwargs)
                ^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_impl_to_api_mapping.py", line 123, in wrapper_func
    return handler(
           ^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/modules/feature_extractor.py", line 358, in on_console
    if payload and payload in (msg.text() or ""):
                               ^^^^^^^^^^
TypeError: 'str' object is not callable
ERROR:backend.modules.feature_extractor:[Navigation Error] http://testfire.net/search.aspx — Page.content: 'str' object is not callable
WARNING:backend.modules.feature_extractor:[Empty HTML] Could not extract content from http://testfire.net/search.aspx
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Cimg+src%3Dx+onerror%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    "family": family,
        ^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Csvg%2Fonload%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    "family": family,
        ^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%22%2F%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    "family": family,
        ^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:     127.0.0.1:61634 - "POST /api/fuzz HTTP/1.1" 200 OK
INFO:     127.0.0.1:62638 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:62668 - "POST /api/job/start HTTP/1.1" 200 OK
INFO:     127.0.0.1:62710 - "POST /api/crawl HTTP/1.1" 200 OK
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/cgi.exe'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/default.jsp?content=security.htm'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/feedback.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/index.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/login.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/search.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/status_check.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/subscribe.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/survey_questions.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/swagger/index.html'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/doLogin'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
[INFO] Starting proactive SPA route discovery for http://testfire.net
[INFO] SPA patterns detected: []
[INFO] Proactively discovered 5 SPA routes
[INFO] SPA patterns detected: []
[INFO] Added 17 SPA routes to discovered endpoints
✅ Grouped & categorized 30 distinct endpoint variants → /Users/raphaelpang/code/elise/data/results/testfire.net/categorized_endpoints.json
INFO:     127.0.0.1:62833 - "GET /api/crawl/status/727d4551-8892-46cc-9169-588f9618ae62 HTTP/1.1" 200 OK
INFO:backend.modules.recommender:Loaded recommender meta: /Users/raphaelpang/code/elise/backend/modules/ml/recommender_meta.json (feature_dim=17)
INFO:backend.modules.recommender:Recommender ready: plugin=False, model=False, pipeline=False, feature_dim=17, rankers_exist={'sqli': True, 'xss': True, 'redirect': True}, family_clf=False, model_dir=/Users/raphaelpang/code/elise/backend/modules/ml
Error occurred in event listener
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 480, in dispatch
    g.switch(self._replace_guids_with_channels(params))
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 471, in _listener_with_error_handler_attached
    potential_future = listener(params)
                       ^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 161, in <lambda>
    lambda event: self._on_console_message(event),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 701, in _on_console_message
    page.emit(Page.Events.Console, message)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 220, in emit
    handled = self._call_handlers(event, args, kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 196, in _call_handlers
    self._emit_run(f, args, kwargs)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 81, in _emit_run
    self.emit("error", exc)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 223, in emit
    self._emit_handle_potential_error(event, args[0] if args else None)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 181, in _emit_handle_potential_error
    raise error
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 79, in _emit_run
    coro: Any = f(*args, **kwargs)
                ^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_impl_to_api_mapping.py", line 123, in wrapper_func
    return handler(
           ^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/modules/feature_extractor.py", line 358, in on_console
    if payload and payload in (msg.text() or ""):
                               ^^^^^^^^^^
TypeError: 'str' object is not callable
ERROR:backend.modules.feature_extractor:[Navigation Error] http://testfire.net/search.aspx — Page.content: 'str' object is not callable
WARNING:backend.modules.feature_extractor:[Empty HTML] Could not extract content from http://testfire.net/search.aspx
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Cimg+src%3Dx+onerror%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Csvg%2Fonload%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%22%2F%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:     127.0.0.1:62880 - "POST /api/fuzz HTTP/1.1" 200 OK
INFO:     127.0.0.1:63334 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63364 - "POST /api/job/start HTTP/1.1" 200 OK
INFO:     127.0.0.1:63408 - "POST /api/crawl HTTP/1.1" 200 OK
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/cgi.exe'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/default.jsp?content=security.htm'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/feedback.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/index.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/login.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/search.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/status_check.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/subscribe.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/survey_questions.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/swagger/index.html'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/doLogin'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
[INFO] Starting proactive SPA route discovery for http://testfire.net
[INFO] SPA patterns detected: []
[INFO] Proactively discovered 5 SPA routes
[INFO] SPA patterns detected: []
[INFO] Added 17 SPA routes to discovered endpoints
✅ Grouped & categorized 30 distinct endpoint variants → /Users/raphaelpang/code/elise/data/results/testfire.net/categorized_endpoints.json
INFO:     127.0.0.1:63522 - "GET /api/crawl/status/73cf262d-a3d2-4309-8249-cc38eeaa01ce HTTP/1.1" 200 OK
INFO:backend.modules.recommender:Loaded recommender meta: /Users/raphaelpang/code/elise/backend/modules/ml/recommender_meta.json (feature_dim=17)
INFO:backend.modules.recommender:Recommender ready: plugin=False, model=False, pipeline=False, feature_dim=17, rankers_exist={'sqli': True, 'xss': True, 'redirect': True}, family_clf=False, model_dir=/Users/raphaelpang/code/elise/backend/modules/ml
Error occurred in event listener
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 480, in dispatch
    g.switch(self._replace_guids_with_channels(params))
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 471, in _listener_with_error_handler_attached
    potential_future = listener(params)
                       ^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 161, in <lambda>
    lambda event: self._on_console_message(event),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 701, in _on_console_message
    page.emit(Page.Events.Console, message)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 220, in emit
    handled = self._call_handlers(event, args, kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 196, in _call_handlers
    self._emit_run(f, args, kwargs)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 81, in _emit_run
    self.emit("error", exc)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 223, in emit
    self._emit_handle_potential_error(event, args[0] if args else None)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 181, in _emit_handle_potential_error
    raise error
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 79, in _emit_run
    coro: Any = f(*args, **kwargs)
                ^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_impl_to_api_mapping.py", line 123, in wrapper_func
    return handler(
           ^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/modules/feature_extractor.py", line 358, in on_console
    if payload and payload in (msg.text() or ""):
                               ^^^^^^^^^^
TypeError: 'str' object is not callable
ERROR:backend.modules.feature_extractor:[Navigation Error] http://testfire.net/search.aspx — Page.content: 'str' object is not callable
WARNING:backend.modules.feature_extractor:[Empty HTML] Could not extract content from http://testfire.net/search.aspx
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Cimg+src%3Dx+onerror%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    }
      
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Csvg%2Fonload%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    }
      
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%22%2F%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    }
      
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:     127.0.0.1:63552 - "POST /api/fuzz HTTP/1.1" 200 OK
INFO:     127.0.0.1:64144 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:64193 - "POST /api/job/start HTTP/1.1" 200 OK
INFO:     127.0.0.1:64231 - "POST /api/crawl HTTP/1.1" 200 OK
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/cgi.exe'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/default.jsp?content=security.htm'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/feedback.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/index.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/login.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/search.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/status_check.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/subscribe.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/survey_questions.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/swagger/index.html'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/doLogin'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
[INFO] Starting proactive SPA route discovery for http://testfire.net
[INFO] SPA patterns detected: []
[INFO] Proactively discovered 5 SPA routes
[INFO] SPA patterns detected: []
[INFO] Added 17 SPA routes to discovered endpoints
✅ Grouped & categorized 30 distinct endpoint variants → /Users/raphaelpang/code/elise/data/results/testfire.net/categorized_endpoints.json
INFO:     127.0.0.1:64359 - "GET /api/crawl/status/aeeca015-83e2-4893-b3bb-ecc60f4363cf HTTP/1.1" 200 OK
INFO:backend.modules.recommender:Loaded recommender meta: /Users/raphaelpang/code/elise/backend/modules/ml/recommender_meta.json (feature_dim=17)
INFO:backend.modules.recommender:Recommender ready: plugin=False, model=False, pipeline=False, feature_dim=17, rankers_exist={'sqli': True, 'xss': True, 'redirect': True}, family_clf=False, model_dir=/Users/raphaelpang/code/elise/backend/modules/ml
Error occurred in event listener
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 480, in dispatch
    g.switch(self._replace_guids_with_channels(params))
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 471, in _listener_with_error_handler_attached
    potential_future = listener(params)
                       ^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 161, in <lambda>
    lambda event: self._on_console_message(event),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 701, in _on_console_message
    page.emit(Page.Events.Console, message)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 220, in emit
    handled = self._call_handlers(event, args, kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 196, in _call_handlers
    self._emit_run(f, args, kwargs)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 81, in _emit_run
    self.emit("error", exc)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 223, in emit
    self._emit_handle_potential_error(event, args[0] if args else None)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 181, in _emit_handle_potential_error
    raise error
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 79, in _emit_run
    coro: Any = f(*args, **kwargs)
                ^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_impl_to_api_mapping.py", line 123, in wrapper_func
    return handler(
           ^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/modules/feature_extractor.py", line 358, in on_console
    if payload and payload in (msg.text() or ""):
                               ^^^^^^^^^^
TypeError: 'str' object is not callable
ERROR:backend.modules.feature_extractor:[Navigation Error] http://testfire.net/search.aspx — Page.content: 'str' object is not callable
WARNING:backend.modules.feature_extractor:[Empty HTML] Could not extract content from http://testfire.net/search.aspx
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Cimg+src%3Dx+onerror%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    "status_changed": (delta or {}).get("status_changed", 0),
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Csvg%2Fonload%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    "status_changed": (delta or {}).get("status_changed", 0),
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%22%2F%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    "status_changed": (delta or {}).get("status_changed", 0),
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:     127.0.0.1:64389 - "POST /api/fuzz HTTP/1.1" 200 OK
INFO:     127.0.0.1:51048 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:51074 - "POST /api/job/start HTTP/1.1" 200 OK
INFO:     127.0.0.1:51112 - "POST /api/crawl HTTP/1.1" 200 OK
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/cgi.exe'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/default.jsp?content=security.htm'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/feedback.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/index.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/login.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/search.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/status_check.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/subscribe.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/survey_questions.jsp'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/swagger/index.html'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `<class 'pydantic.networks.HttpUrl'>` but got `<class 'str'>` with value `'http://testfire.net/doLogin'` - serialized value may not be as expected.)
  return self.__pydantic_serializer__.to_python(
[INFO] Starting proactive SPA route discovery for http://testfire.net
[INFO] SPA patterns detected: []
[INFO] Proactively discovered 5 SPA routes
[INFO] SPA patterns detected: []
[INFO] Added 17 SPA routes to discovered endpoints
✅ Grouped & categorized 30 distinct endpoint variants → /Users/raphaelpang/code/elise/data/results/testfire.net/categorized_endpoints.json
INFO:     127.0.0.1:51327 - "GET /api/crawl/status/deb141a3-44a5-4a10-812d-f54baf648aad HTTP/1.1" 200 OK
INFO:backend.modules.recommender:Loaded recommender meta: /Users/raphaelpang/code/elise/backend/modules/ml/recommender_meta.json (feature_dim=17)
INFO:backend.modules.recommender:Recommender ready: plugin=False, model=False, pipeline=False, feature_dim=17, rankers_exist={'sqli': True, 'xss': True, 'redirect': True}, family_clf=False, model_dir=/Users/raphaelpang/code/elise/backend/modules/ml
Error occurred in event listener
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 480, in dispatch
    g.switch(self._replace_guids_with_channels(params))
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 471, in _listener_with_error_handler_attached
    potential_future = listener(params)
                       ^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 161, in <lambda>
    lambda event: self._on_console_message(event),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 701, in _on_console_message
    page.emit(Page.Events.Console, message)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 220, in emit
    handled = self._call_handlers(event, args, kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 196, in _call_handlers
    self._emit_run(f, args, kwargs)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 81, in _emit_run
    self.emit("error", exc)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 223, in emit
    self._emit_handle_potential_error(event, args[0] if args else None)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 181, in _emit_handle_potential_error
    raise error
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 79, in _emit_run
    coro: Any = f(*args, **kwargs)
                ^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_impl_to_api_mapping.py", line 123, in wrapper_func
    return handler(
           ^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/modules/feature_extractor.py", line 358, in on_console
    if payload and payload in (msg.text() or ""):
                               ^^^^^^^^^^
TypeError: 'str' object is not callable
ERROR:backend.modules.feature_extractor:[Navigation Error] http://testfire.net/search.aspx — Page.content: 'str' object is not callable
WARNING:backend.modules.feature_extractor:[Empty HTML] Could not extract content from http://testfire.net/search.aspx
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Cimg+src%3Dx+onerror%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Csvg%2Fonload%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%22%2F%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:     127.0.0.1:51355 - "POST /api/fuzz HTTP/1.1" 200 OK
INFO:backend.modules.recommender:Loaded recommender meta: /Users/raphaelpang/code/elise/backend/modules/ml/recommender_meta.json (feature_dim=17)
INFO:backend.modules.recommender:Recommender ready: plugin=False, model=False, pipeline=False, feature_dim=17, rankers_exist={'sqli': True, 'xss': True, 'redirect': True}, family_clf=False, model_dir=/Users/raphaelpang/code/elise/backend/modules/ml
Error occurred in event listener
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 480, in dispatch
    g.switch(self._replace_guids_with_channels(params))
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 471, in _listener_with_error_handler_attached
    potential_future = listener(params)
                       ^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 161, in <lambda>
    lambda event: self._on_console_message(event),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 701, in _on_console_message
    page.emit(Page.Events.Console, message)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 220, in emit
    handled = self._call_handlers(event, args, kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 196, in _call_handlers
    self._emit_run(f, args, kwargs)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 81, in _emit_run
    self.emit("error", exc)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 223, in emit
    self._emit_handle_potential_error(event, args[0] if args else None)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 181, in _emit_handle_potential_error
    raise error
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 79, in _emit_run
    coro: Any = f(*args, **kwargs)
                ^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_impl_to_api_mapping.py", line 123, in wrapper_func
    return handler(
           ^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/modules/feature_extractor.py", line 358, in on_console
    if payload and payload in (msg.text() or ""):
                               ^^^^^^^^^^
TypeError: 'str' object is not callable
ERROR:backend.modules.feature_extractor:[Navigation Error] http://testfire.net/search.aspx — Page.content: 'str' object is not callable
WARNING:backend.modules.feature_extractor:[Empty HTML] Could not extract content from http://testfire.net/search.aspx
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Cimg+src%3Dx+onerror%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Csvg%2Fonload%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%22%2F%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:     127.0.0.1:51564 - "POST /api/fuzz HTTP/1.1" 200 OK
INFO:     127.0.0.1:51809 - "GET /health HTTP/1.1" 200 OK
INFO:backend.modules.recommender:Loaded recommender meta: /Users/raphaelpang/code/elise/backend/modules/ml/recommender_meta.json (feature_dim=17)
INFO:backend.modules.recommender:Recommender ready: plugin=False, model=False, pipeline=False, feature_dim=17, rankers_exist={'sqli': True, 'xss': True, 'redirect': True}, family_clf=False, model_dir=/Users/raphaelpang/code/elise/backend/modules/ml
Error occurred in event listener
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 480, in dispatch
    g.switch(self._replace_guids_with_channels(params))
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 471, in _listener_with_error_handler_attached
    potential_future = listener(params)
                       ^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 161, in <lambda>
    lambda event: self._on_console_message(event),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 701, in _on_console_message
    page.emit(Page.Events.Console, message)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 220, in emit
    handled = self._call_handlers(event, args, kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 196, in _call_handlers
    self._emit_run(f, args, kwargs)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 81, in _emit_run
    self.emit("error", exc)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 223, in emit
    self._emit_handle_potential_error(event, args[0] if args else None)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 181, in _emit_handle_potential_error
    raise error
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 79, in _emit_run
    coro: Any = f(*args, **kwargs)
                ^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_impl_to_api_mapping.py", line 123, in wrapper_func
    return handler(
           ^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/modules/feature_extractor.py", line 358, in on_console
    if payload and payload in (msg.text() or ""):
                               ^^^^^^^^^^
TypeError: 'str' object is not callable
ERROR:backend.modules.feature_extractor:[Navigation Error] http://testfire.net/search.aspx — Page.content: 'str' object is not callable
WARNING:backend.modules.feature_extractor:[Empty HTML] Could not extract content from http://testfire.net/search.aspx
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Cimg+src%3Dx+onerror%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Csvg%2Fonload%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%22%2F%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:     127.0.0.1:51845 - "POST /api/fuzz HTTP/1.1" 200 OK
INFO:     127.0.0.1:57680 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57705 - "GET /api/enhanced-fuzz/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:58268 - "GET /api/enhanced-fuzz/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:58338 - "GET /api/enhanced-fuzz/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:58366 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:58416 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:58439 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:58636 - "GET /api/enhanced-fuzz/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:58795 - "GET /api/enhanced-fuzz/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:58846 - "GET /api/enhanced-fuzz/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:58874 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:58953 - "GET /api/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:59462 - "GET /health HTTP/1.1" 200 OK
INFO:backend.modules.recommender:Loaded recommender meta: /Users/raphaelpang/code/elise/backend/modules/ml/recommender_meta.json (feature_dim=17)
INFO:backend.modules.recommender:Recommender ready: plugin=False, model=False, pipeline=False, feature_dim=17, rankers_exist={'sqli': True, 'xss': True, 'redirect': True}, family_clf=False, model_dir=/Users/raphaelpang/code/elise/backend/modules/ml
Error occurred in event listener
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 480, in dispatch
    g.switch(self._replace_guids_with_channels(params))
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 471, in _listener_with_error_handler_attached
    potential_future = listener(params)
                       ^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 161, in <lambda>
    lambda event: self._on_console_message(event),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 701, in _on_console_message
    page.emit(Page.Events.Console, message)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 220, in emit
    handled = self._call_handlers(event, args, kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 196, in _call_handlers
    self._emit_run(f, args, kwargs)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 81, in _emit_run
    self.emit("error", exc)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 223, in emit
    self._emit_handle_potential_error(event, args[0] if args else None)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 181, in _emit_handle_potential_error
    raise error
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 79, in _emit_run
    coro: Any = f(*args, **kwargs)
                ^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_impl_to_api_mapping.py", line 123, in wrapper_func
    return handler(
           ^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/modules/feature_extractor.py", line 358, in on_console
    if payload and payload in (msg.text() or ""):
                               ^^^^^^^^^^
TypeError: 'str' object is not callable
ERROR:backend.modules.feature_extractor:[Navigation Error] http://testfire.net/search.aspx — Page.content: 'str' object is not callable
WARNING:backend.modules.feature_extractor:[Empty HTML] Could not extract content from http://testfire.net/search.aspx
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Cimg+src%3Dx+onerror%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Csvg%2Fonload%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%22%2F%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:     127.0.0.1:59506 - "POST /api/fuzz HTTP/1.1" 200 OK
INFO:backend.modules.recommender:Loaded recommender meta: /Users/raphaelpang/code/elise/backend/modules/ml/recommender_meta.json (feature_dim=17)
INFO:backend.modules.recommender:Recommender ready: plugin=False, model=False, pipeline=False, feature_dim=17, rankers_exist={'sqli': True, 'xss': True, 'redirect': True}, family_clf=False, model_dir=/Users/raphaelpang/code/elise/backend/modules/ml
Error occurred in event listener
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 480, in dispatch
    g.switch(self._replace_guids_with_channels(params))
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_connection.py", line 471, in _listener_with_error_handler_attached
    potential_future = listener(params)
                       ^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 161, in <lambda>
    lambda event: self._on_console_message(event),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_browser_context.py", line 701, in _on_console_message
    page.emit(Page.Events.Console, message)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 220, in emit
    handled = self._call_handlers(event, args, kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 196, in _call_handlers
    self._emit_run(f, args, kwargs)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 81, in _emit_run
    self.emit("error", exc)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 70, in emit
    return super().emit(event, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 223, in emit
    self._emit_handle_potential_error(event, args[0] if args else None)
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/base.py", line 181, in _emit_handle_potential_error
    raise error
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/pyee/asyncio.py", line 79, in _emit_run
    coro: Any = f(*args, **kwargs)
                ^^^^^^^^^^^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/venv/lib/python3.12/site-packages/playwright/_impl/_impl_to_api_mapping.py", line 123, in wrapper_func
    return handler(
           ^^^^^^^^
  File "/Users/raphaelpang/code/elise/backend/modules/feature_extractor.py", line 358, in on_console
    if payload and payload in (msg.text() or ""):
                               ^^^^^^^^^^
TypeError: 'str' object is not callable
ERROR:backend.modules.feature_extractor:[Navigation Error] http://testfire.net/search.aspx — Page.content: 'str' object is not callable
WARNING:backend.modules.feature_extractor:[Empty HTML] Could not extract content from http://testfire.net/search.aspx
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Cimg+src%3Dx+onerror%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%3Csvg%2Fonload%3Dalert%281%29%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:httpx:HTTP Request: GET http://testfire.net/search.aspx?q=%22%2F%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E "HTTP/1.1 404 Not Found"
ERROR:root:persist_evidence failed
Traceback (most recent call last):
  File "/Users/raphaelpang/code/elise/backend/routes/fuzz_routes.py", line 679, in _fuzz_targets_ffuf
    # keep only the three we render; renormalize
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: persist_evidence() got an unexpected keyword argument 'ranker_meta'
INFO:     127.0.0.1:59827 - "POST /api/fuzz HTTP/1.1" 200 OK
INFO:     127.0.0.1:60739 - "POST /api/fuzz-enhanced-ml HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:60792 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:60831 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:64028 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:64052 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:64077 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:64183 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:64271 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:64304 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:64564 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:64665 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:64688 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:64714 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:64761 - "GET /api/enhanced-fuzz HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:65154 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:65376 - "GET /api/test HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:49271 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:49483 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:49533 - "POST /api/enhanced-fuzz HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:50203 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:50226 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:50936 - "GET /api/test HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:50974 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:51245 - "GET /api/simple-test HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:51325 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:51370 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:51410 - "POST /api/enhanced-fuzz HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:51859 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:53198 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:53223 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:53250 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:53270 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:53379 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:53418 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:53563 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:53606 - "GET /api/enhanced-fuzz/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:53714 - "GET /api/enhanced-fuzz HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:53742 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:53941 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:53961 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:54365 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:54387 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:54423 - "GET /api/enhanced-fuzz/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:54705 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:54731 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:55085 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:55127 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:55157 - "GET /api/enhanced-fuzz/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:55890 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:55927 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:55953 - "GET /api/enhanced-fuzz/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56169 - "GET /api/enhanced-fuzz/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56286 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:56312 - "GET /api/enhanced-fuzz/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56347 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:56402 - "GET /api/enhanced-health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:61752 - "GET /api/enhanced-fuzz/health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:61846 - "GET /api/enhanced-health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:61922 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:61990 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:50858 - "GET /api/enhanced-health HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:50884 - "GET /openapi.json HTTP/1.1" 200 OK
